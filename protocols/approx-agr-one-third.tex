\begin{cccProtocol}
    {$\mathsf{{\frac{1}{3}-}ApproxAgr}(\ell, m, T)$}
    {one-third-approximate-consensus}
    {Weak/Approxmate Agreeement tolerating a $(1 / 3)$-bounded adversary.}

    \begin{algorithmic}[1]
        \LineComment{The following code is executed in each round \round (\val is the party input)}
        \If{$\round \le \ell$} \Comment{Step 1: mine and exchange messages.}

        \State{Fetch information and denote incoming PoW messages by $((r_1, v_1), \ldots, (r_n, v_n))$}
        \For{each $(r_i, v_i)$}
        \State{Set $c = |\{j \mathbin| j \in [m] \wedge \stringSegment{H(r_i, v_i)}{j}{m} < T\}|$}
        \State{Append $v_i$ to $\mathbf{V}$ for $c$ times}
        \EndFor

        \State{Set $u \gets H(ctr, \val)$}
        \oneLineIf{$\exists j \in [m]$ s.t. $\stringSegment{u}{j}{m} < T$}{Diffuse $(ctr, \val)$}

        \State{$ctr \gets ctr + 1$}

        \Else  \Comment{Step 2: decide output.}

        \State{Order $\mathbf{V}$ non-decreasingly and denote $n \gets |\mathbf{V}|$} \label{code:ordered-array}

        \If{deciding output for weak agreement}
        \oneLineIf{$\mathbf{V}_{n / 3} = \mathbf{V}_{2n / 3}$}{output $\mathbf{V}_{n / 3}$ \textbf{else} output $\bot$}
        \ElsIf{deciding output for approximate agreement}
        \State{Output the mid point of $\mathsf{reduce}(\mathbf{V}, n / 3)$}
        \EndIf

        \EndIf
    \end{algorithmic}
\end{cccProtocol}